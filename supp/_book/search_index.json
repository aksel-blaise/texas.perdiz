[["index.html", "An exploratory analysis of Perdiz arrow point morphology in Texas Preface 0.1 Basis of inquiry 0.2 Primary findings 0.3 Acknowledgments 0.4 Funding 0.5 Data management 0.6 Colophon", " An exploratory analysis of Perdiz arrow point morphology in Texas Robert Z. Selden, Jr., Bonnie L. Etter, and B. Sunday Eiselt 2021-03-17 Preface Reproducibilitythe ability to recompute resultsand replicabilitythe chances other experimenters will achieve a consistent resultare two foundational characteristics of successful scientific research (Leek and Peng 2015). This volume is written using Markdown, and includes all analysis code employed in the study, providing a means for others to reproduce (exactly) those results discussed and expounded upon in the following chapters. The replicable nature of this undertaking provides a means for others to critically assess and evaluate the various analytical components of this study (Gray and Marwick 2019; Peng 2011; Gandrud 2014), which is a necessary requirement for the production of reliable knowledge. 0.1 Basis of inquiry The Toyah Phase has been the center of debate about Texas prehistory, since J. Charles Kelly first defined it in 1947. Known widely as the Toyah Phase Paradox, research has struggled to reconcile the homogenous expression of this protohistoric to historic archaeological record in central Texas and the high levels of ethnic diversity witnessed by French and Spanish explorers at the turn of the 18th-century. Recent studies have related geographic and temporal variation in artifact styles to communities of practice using standard 2D measurement techniques, with varying degrees of success. We build on this research by using a 3D geometric morphometric approach to examine previously published photographs of Perdiz projectile points (176 points) from sites across the state, a hallmark of Toyah assemblages. The primary goal of the study is to explore how 2D imaging and geometric morphometric analyses can identify localized variants of Perdiz points based on shape. This work, in turn, may be used to infer patterns of interaction between village clusters through network analyses at the regional scale. Implications for how cultural plurality in central Texas may have influenced Spanish missionization are discussed. The goal of this endeavour  0.2 Primary findings 0.3 Acknowledgments We extend our gratitude to the Material Sciences Laboratory at Southern Methodist University, the Williamson Museum at Northwestern State University, the Louisiana State Exhibit Museum, the Texas Archeological Research Laboratory at The University of Texas at Austin, and the Louisiana State University Museum of Natural Science for the requisite permissions, access, and space needed to generate 3D scans of Caddo bottles. Thanks also to Dean C. Adams, Michael L. Collyer, Emma Sherratt, Michael J. Shott, Hiram F. (Pete) Gregory, B. Sunday Eiselt, and Kersten Bergstrom for their constructive criticisms, comments, and suggestions throughout the development of this research programme, as well as the editors and anonymous reviewers whose comments improved the manuscript. 0.4 Funding Development of analytical components used in this analysis was funded by a grant to RZS (P14AP00138) from the National Center for Preservation Technology and Training. 0.5 Data management The data and analysis code associated with this project can be accessed through this document or the GitHub repository, which is digitally curated on the Open Science Framework (DOI: link here. 0.6 Colophon This version of the analysis was generated on 2021-03-17 16:39:22 using the following computational environment and dependencies: # what R packages and versions were used? if (&quot;devtools&quot; %in% installed.packages()) devtools::session_info() ## - Session info ---------------------------------------------------------------------------------------------------------- ## setting value ## version R version 4.0.4 (2021-02-15) ## os Windows 10 x64 ## system x86_64, mingw32 ## ui RStudio ## language (EN) ## collate English_United States.1252 ## ctype English_United States.1252 ## tz America/Chicago ## date 2021-03-17 ## ## - Packages -------------------------------------------------------------------------------------------------------------- ## package * version date lib source ## ape 5.4-1 2020-08-13 [1] CRAN (R 4.0.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.0.2) ## bezier 1.1.2 2018-12-14 [1] CRAN (R 4.0.3) ## bookdown 0.21 2020-10-13 [1] CRAN (R 4.0.3) ## brew 1.0-6 2011-04-13 [1] CRAN (R 4.0.0) ## bslib 0.2.4 2021-01-25 [1] CRAN (R 4.0.3) ## cachem 1.0.4 2021-02-13 [1] CRAN (R 4.0.4) ## callr 3.5.1 2020-10-13 [1] CRAN (R 4.0.3) ## cli 2.3.1 2021-02-23 [1] CRAN (R 4.0.4) ## colorspace 2.0-0 2020-11-11 [1] CRAN (R 4.0.3) ## crayon 1.4.1 2021-02-08 [1] CRAN (R 4.0.3) ## crosstalk 1.1.1 2021-01-12 [1] CRAN (R 4.0.3) ## DBI 1.1.1 2021-01-15 [1] CRAN (R 4.0.3) ## desc 1.3.0 2021-03-05 [1] CRAN (R 4.0.4) ## devtools 2.3.2 2020-09-18 [1] CRAN (R 4.0.2) ## digest 0.6.27 2020-10-24 [1] CRAN (R 4.0.3) ## dplyr 1.0.5 2021-03-05 [1] CRAN (R 4.0.4) ## ellipsis 0.3.1 2020-05-15 [1] CRAN (R 4.0.2) ## evaluate 0.14 2019-05-28 [1] CRAN (R 4.0.2) ## fansi 0.4.2 2021-01-15 [1] CRAN (R 4.0.3) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.0.4) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.0.3) ## fs 1.5.0 2020-07-31 [1] CRAN (R 4.0.2) ## generics 0.1.0 2020-10-31 [1] CRAN (R 4.0.3) ## geomorph * 3.3.2 2021-01-23 [1] Github (geomorphR/geomorph@788ab5b) ## ggplot2 * 3.3.3 2020-12-30 [1] CRAN (R 4.0.3) ## git2r 0.28.0 2021-01-10 [1] CRAN (R 4.0.3) ## glue 1.4.2 2020-08-27 [1] CRAN (R 4.0.2) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.0.2) ## here * 1.0.1 2020-12-13 [1] CRAN (R 4.0.3) ## highr 0.8 2019-03-20 [1] CRAN (R 4.0.2) ## htmltools 0.5.1.1 2021-01-22 [1] CRAN (R 4.0.3) ## htmlwidgets 1.5.3 2020-12-10 [1] CRAN (R 4.0.3) ## httpuv 1.5.5 2021-01-13 [1] CRAN (R 4.0.3) ## jpeg 0.1-8.1 2019-10-24 [1] CRAN (R 4.0.0) ## jquerylib 0.1.3 2020-12-17 [1] CRAN (R 4.0.3) ## jsonlite 1.7.2 2020-12-09 [1] CRAN (R 4.0.3) ## knitr 1.31 2021-01-27 [1] CRAN (R 4.0.3) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.0.3) ## later 1.1.0.1 2020-06-05 [1] CRAN (R 4.0.2) ## lattice 0.20-41 2020-04-02 [2] CRAN (R 4.0.4) ## lifecycle 1.0.0 2021-02-15 [1] CRAN (R 4.0.4) ## magrittr 2.0.1 2020-11-17 [1] CRAN (R 4.0.3) ## manipulateWidget 0.10.1 2020-02-24 [1] CRAN (R 4.0.2) ## MASS 7.3-53.1 2021-02-12 [1] CRAN (R 4.0.4) ## memoise 2.0.0 2021-01-26 [1] CRAN (R 4.0.3) ## mime 0.10 2021-02-13 [1] CRAN (R 4.0.4) ## miniUI 0.1.1.1 2018-05-18 [1] CRAN (R 4.0.2) ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.0.2) ## nlme 3.1-152 2021-02-04 [2] CRAN (R 4.0.4) ## pillar 1.5.1 2021-03-05 [1] CRAN (R 4.0.4) ## pkgbuild 1.2.0 2020-12-15 [1] CRAN (R 4.0.3) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.0.2) ## pkgload 1.2.0 2021-02-23 [1] CRAN (R 4.0.4) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.0.0) ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.0.2) ## processx 3.4.5 2020-11-30 [1] CRAN (R 4.0.3) ## promises 1.2.0.1 2021-02-11 [1] CRAN (R 4.0.3) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.0.4) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.0.2) ## R6 2.5.0 2020-10-28 [1] CRAN (R 4.0.3) ## Rcpp 1.0.6 2021-01-15 [1] CRAN (R 4.0.3) ## remotes 2.2.0 2020-07-21 [1] CRAN (R 4.0.2) ## rgl * 0.105.22 2021-03-04 [1] CRAN (R 4.0.4) ## rjson 0.2.20 2018-06-08 [1] CRAN (R 4.0.0) ## rlang 0.4.10 2020-12-30 [1] CRAN (R 4.0.3) ## rmarkdown 2.7 2021-02-19 [1] CRAN (R 4.0.4) ## Rook 1.1-1 2014-10-20 [1] CRAN (R 4.0.3) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.0.3) ## RRPP * 0.6.2 2021-01-11 [1] CRAN (R 4.0.3) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.0.3) ## sass 0.3.1 2021-01-24 [1] CRAN (R 4.0.3) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.0.2) ## sessioninfo 1.1.1 2018-11-05 [1] CRAN (R 4.0.2) ## shiny 1.6.0 2021-01-25 [1] CRAN (R 4.0.3) ## StereoMorph * 1.6.3 2019-11-30 [1] CRAN (R 4.0.3) ## stringi 1.5.3 2020-09-09 [1] CRAN (R 4.0.2) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.0.2) ## svgViewR 1.4.1 2020-10-03 [1] CRAN (R 4.0.3) ## testthat 3.0.2 2021-02-14 [1] CRAN (R 4.0.4) ## tibble 3.1.0 2021-02-25 [1] CRAN (R 4.0.4) ## tidyselect 1.1.0 2020-05-11 [1] CRAN (R 4.0.2) ## tiff 0.1-7 2021-03-02 [1] CRAN (R 4.0.4) ## tinytex 0.30 2021-03-04 [1] CRAN (R 4.0.4) ## usethis 2.0.1 2021-02-10 [1] CRAN (R 4.0.3) ## utf8 1.2.1 2021-03-12 [1] CRAN (R 4.0.4) ## vctrs 0.3.6 2020-12-17 [1] CRAN (R 4.0.3) ## webshot 0.5.2 2019-11-22 [1] CRAN (R 4.0.2) ## wesanderson * 0.3.6 2018-04-20 [1] CRAN (R 4.0.2) ## withr 2.4.1 2021-01-26 [1] CRAN (R 4.0.3) ## xfun 0.22 2021-03-11 [1] CRAN (R 4.0.4) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.0.2) ## yaml 2.2.1 2020-02-01 [1] CRAN (R 4.0.0) ## ## [1] C:/Users/seldenjrz/Documents/R/win-library/4.0 ## [2] C:/Program Files/R/R-4.0.4/library Current Git commit details are: # where can I find this commit? if (&quot;git2r&quot; %in% installed.packages() &amp; git2r::in_repository(path = &quot;.&quot;)) git2r::repository(here::here()) ## Local: main D:/github/texas.perdiz ## Remote: main @ origin (https://github.com/aksel-blaise/texas.perdiz) ## Head: [ac41936] 2021-03-17: Initial commit "],["landmarking-protocol.html", "Chapter 1 Landmarking protocol", " Chapter 1 Landmarking protocol "],["natural-regions.html", "Chapter 2 Natural regions 2.1 Read data and define sLMs 2.2 Read qualitative data 2.3 Generalised Procrustes Analysis 2.4 Boxplot 2.5 Principal Components Analysis 2.6 Procrustes ANOVA - allometry 2.7 Procrustes ANOVA - shape and size 2.8 Morphological integration 2.9 Morphological disparity 2.10 Mean shapes", " Chapter 2 Natural regions library(here) library(StereoMorph) library(geomorph) library(wesanderson) library(ggplot2) 2.1 Read data and define sLMs shapes &lt;- readShapes(&quot;shapes&quot;) shapesGM &lt;- readland.shapes(shapes, nCurvePts = c(10, 10, 10, 10)) 2.2 Read qualitative data qdata &lt;- read.csv(&quot;qdata.csv&quot;, header = TRUE, row.names = 1) 2.3 Generalised Procrustes Analysis Landmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalised Procrustes superimposition (Rohlf and Slice 1990) performed in R 4.0.4 (R Core Development Team, 2020) using the geomorph library v. 3.3.2 (Adams et al. 2017; Adams and Otárola-Castillo 2013). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001). Y.gpa &lt;- gpagen(shapesGM, print.progress = FALSE) plot(Y.gpa) # dataframe gdf &lt;- geomorph.data.frame(shape = Y.gpa$coords, size = Y.gpa$Csize, region = qdata$region) # add centroid size to qdata qdata$csz &lt;- Y.gpa$Csize # revised table of attributes knitr::kable(qdata, align = &quot;lccc&quot;, caption = &quot;Attributes of Perdiz arrow points included in the sample.&quot;) Table 2.1: Attributes of Perdiz arrow points included in the sample. county river region csz perdiz001a kimble Colorado edwards plateau 69.35797 perdiz001b kimble Colorado edwards plateau 73.14749 perdiz001c kimble Colorado edwards plateau 58.52238 perdiz002 kimble Colorado edwards plateau 70.84758 perdiz003 bosque Colorado blackland prairies 60.02730 perdiz004e kimble Colorado edwards plateau 60.43875 perdiz004g kimble Colorado edwards plateau 50.37065 perdiz005a JW, hinojosa site NRG gulf coast prairies and marshes 38.60532 perdiz005b JW, hinojosa site NRG gulf coast prairies and marshes 36.04801 perdiz005c JW, hinojosa site NRG gulf coast prairies and marshes 31.63170 perdiz005e JW, hinojosa site NRG gulf coast prairies and marshes 38.73303 perdiz005g JW, hinojosa site NRG gulf coast prairies and marshes 42.18146 perdiz005h JW, hinojosa site NRG gulf coast prairies and marshes 40.21831 perdiz005i JW, hinojosa site NRG gulf coast prairies and marshes 46.89038 perdiz005j JW, hinojosa site NRG gulf coast prairies and marshes 47.12634 perdiz005k JW, hinojosa site NRG gulf coast prairies and marshes 44.19071 perdiz005L JW, hinojosa site NRG gulf coast prairies and marshes 49.62448 perdiz005o JW, hinojosa site NRG gulf coast prairies and marshes 50.95445 perdiz005q JW, hinojosa site NRG gulf coast prairies and marshes 54.49649 perdiz005r JW, hinojosa site NRG gulf coast prairies and marshes 56.57031 perdiz005t JW, hinojosa site NRG gulf coast prairies and marshes 64.34497 perdiz005u JW, hinojosa site NRG gulf coast prairies and marshes 64.37136 perdiz005x JW, hinojosa site NRG gulf coast prairies and marshes 71.34271 perdiz006a JW, hinojosa site NRG gulf coast prairies and marshes 56.62909 perdiz006b JW, hinojosa site NRG gulf coast prairies and marshes 53.55270 perdiz006g JW, hinojosa site NRG gulf coast prairies and marshes 48.91144 perdiz006h JW, hinojosa site NRG gulf coast prairies and marshes 46.08079 perdiz007 McLennan Brazos blackland prairies 61.28651 perdiz008cap uvalde Nueces edwards plateau 77.02208 perdiz008iap uvalde Nueces edwards plateau 74.75191 perdiz008oap uvalde Nueces edwards plateau 49.62793 perdiz008pap uvalde Nueces edwards plateau 50.87638 perdiz008x uvalde Nueces edwards plateau 43.59739 perdiz010 hamilton Brazos oak woods and parairies 70.21314 perdiz011 lampass Brazos edwards plateau 72.06248 perdiz012a burleson Brazos oak woods and parairies 46.88491 perdiz012c burleson Brazos oak woods and parairies 50.39119 perdiz014 lee Brazos oak woods and parairies 54.06644 perdiz015 comal Guadalupe edwards plateau 55.79778 perdiz016 hays Guadalupe edwards plateau 54.92731 perdiz017a hays Guadalupe edwards plateau 71.77669 perdiz017d hays Guadalupe edwards plateau 41.21730 perdiz017f hays Guadalupe edwards plateau 62.83886 perdiz018 burleson Brazos oak woods and parairies 62.86062 perdiz020a nacogdoches Neches piney woods 84.92990 perdiz020b nacogdoches Neches piney woods 88.53429 perdiz020c nacogdoches Neches piney woods 93.11325 perdiz021a nacogdoches Neches piney woods 73.68651 perdiz021b nacogdoches Neches piney woods 76.01294 perdiz021c nacogdoches Neches piney woods 90.56510 perdiz021d nacogdoches Neches piney woods 82.10799 perdiz021e nacogdoches Neches piney woods 79.06205 perdiz021f nacogdoches Neches piney woods 84.65951 perdiz021g nacogdoches Neches piney woods 83.23678 perdiz021h nacogdoches Neches piney woods 106.71703 perdiz021i nacogdoches Neches piney woods 148.79264 perdiz022h smith Neches piney woods 38.75136 perdiz022i smith Neches piney woods 43.52312 perdiz022j smith Neches piney woods 39.80383 perdiz022k smith Neches piney woods 36.64441 perdiz022L smith Neches piney woods 38.71038 perdiz022m smith Neches piney woods 41.86583 perdiz023a smith Neches piney woods 78.64626 perdiz023b smith Neches piney woods 78.28938 perdiz023c smith Neches piney woods 80.12793 perdiz023e smith Neches piney woods 77.31495 perdiz023f smith Neches piney woods 80.30418 perdiz023g smith Neches piney woods 63.26502 perdiz024j smith Neches piney woods 44.17576 perdiz025c smith Neches piney woods 75.65424 2.4 Boxplot # attributes csz &lt;- qdata$csz region &lt;- qdata$region # palette pal = wes_palette(&quot;Darjeeling1&quot;, 5, type = &quot;continuous&quot;) # boxplot of Perdiz arrow points by region csz.reg &lt;- ggplot(qdata, aes(x = region, y = csz, color = region)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_color_manual(values = pal) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Region&#39;, y = &#39;Centroid Size&#39;) # render plot csz.reg ## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`. 2.5 Principal Components Analysis Principal components analysis (Jolliffe 2002) was used to visualise shape variation among the bottles. The shape changes described by each principal axis are commonly visualised using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014). # pca pca &lt;- gm.prcomp(Y.gpa$coords) summary(pca) ## ## Ordination type: Principal Component Analysis ## Centering by OLS mean ## Orthogonal projection of OLS residuals ## Number of observations: 70 ## Number of vectors 70 ## ## Importance of Components: ## Comp1 Comp2 Comp3 Comp4 Comp5 Comp6 Comp7 Comp8 ## Eigenvalues 0.0133888 0.00763512 0.002277268 0.001174328 0.0008016969 0.0005434213 0.0004363314 0.0002189984 ## Proportion of Variance 0.4848225 0.27647560 0.082462223 0.042523634 0.0290302741 0.0196778491 0.0158000126 0.0079301596 ## Cumulative Proportion 0.4848225 0.76129808 0.843760298 0.886283932 0.9153142064 0.9349920556 0.9507920681 0.9587222278 ## Comp9 Comp10 Comp11 Comp12 Comp13 Comp14 Comp15 ## Eigenvalues 0.0001830032 0.000138613 0.0001254942 0.000120320 8.565046e-05 7.500234e-05 5.588002e-05 ## Proportion of Variance 0.0066267365 0.005019321 0.0045442736 0.004356912 3.101492e-03 2.715913e-03 2.023473e-03 ## Cumulative Proportion 0.9653489643 0.970368285 0.9749125589 0.979269470 9.823710e-01 9.850869e-01 9.871103e-01 ## Comp16 Comp17 Comp18 Comp19 Comp20 Comp21 Comp22 ## Eigenvalues 4.794711e-05 3.799271e-05 3.720787e-05 3.334601e-05 2.508818e-05 2.368646e-05 1.879945e-05 ## Proportion of Variance 1.736215e-03 1.375756e-03 1.347336e-03 1.207494e-03 9.084689e-04 8.577114e-04 6.807477e-04 ## Cumulative Proportion 9.888466e-01 9.902223e-01 9.915697e-01 9.927771e-01 9.936856e-01 9.945433e-01 9.952241e-01 ## Comp23 Comp24 Comp25 Comp26 Comp27 Comp28 Comp29 ## Eigenvalues 1.714548e-05 1.584305e-05 1.108422e-05 1.091661e-05 9.222024e-06 8.875078e-06 7.861366e-06 ## Proportion of Variance 6.208557e-04 5.736934e-04 4.013712e-04 3.953016e-04 3.339390e-04 3.213758e-04 2.846682e-04 ## Cumulative Proportion 9.958449e-01 9.964186e-01 9.968200e-01 9.972153e-01 9.975492e-01 9.978706e-01 9.981553e-01 ## Comp30 Comp31 Comp32 Comp33 Comp34 Comp35 Comp36 ## Eigenvalues 7.098653e-06 6.020584e-06 5.162380e-06 4.611750e-06 3.632503e-06 3.570610e-06 3.013451e-06 ## Proportion of Variance 2.570496e-04 2.180116e-04 1.869351e-04 1.669962e-04 1.315367e-04 1.292955e-04 1.091202e-04 ## Cumulative Proportion 9.984123e-01 9.986303e-01 9.988173e-01 9.989843e-01 9.991158e-01 9.992451e-01 9.993542e-01 ## Comp37 Comp38 Comp39 Comp40 Comp41 Comp42 Comp43 ## Eigenvalues 2.723580e-06 2.244377e-06 1.784666e-06 1.488843e-06 1.367558e-06 1.199828e-06 1.078477e-06 ## Proportion of Variance 9.862365e-05 8.127120e-05 6.462460e-05 5.391254e-05 4.952068e-05 4.344702e-05 3.905277e-05 ## Cumulative Proportion 9.994528e-01 9.995341e-01 9.995987e-01 9.996527e-01 9.997022e-01 9.997456e-01 9.997847e-01 ## Comp44 Comp45 Comp46 Comp47 Comp48 Comp49 Comp50 ## Eigenvalues 1.043211e-06 9.672424e-07 7.513816e-07 6.535789e-07 5.022591e-07 4.111047e-07 3.271620e-07 ## Proportion of Variance 3.777577e-05 3.502485e-05 2.720831e-05 2.366677e-05 1.818732e-05 1.488653e-05 1.184688e-05 ## Cumulative Proportion 9.998225e-01 9.998575e-01 9.998847e-01 9.999084e-01 9.999265e-01 9.999414e-01 9.999533e-01 ## Comp51 Comp52 Comp53 Comp54 Comp55 Comp56 Comp57 ## Eigenvalues 2.927700e-07 2.208875e-07 1.707167e-07 1.175671e-07 1.010394e-07 8.530899e-08 7.278124e-08 ## Proportion of Variance 1.060150e-05 7.998565e-06 6.181827e-06 4.257227e-06 3.658740e-06 3.089127e-06 2.635484e-06 ## Cumulative Proportion 9.999639e-01 9.999719e-01 9.999781e-01 9.999823e-01 9.999860e-01 9.999891e-01 9.999917e-01 ## Comp58 Comp59 Comp60 Comp61 Comp62 Comp63 Comp64 ## Eigenvalues 6.711195e-08 4.434921e-08 3.069964e-08 2.658065e-08 2.184144e-08 1.563845e-08 1.158589e-08 ## Proportion of Variance 2.430193e-06 1.605931e-06 1.111666e-06 9.625130e-07 7.909012e-07 5.662844e-07 4.195370e-07 ## Cumulative Proportion 9.999941e-01 9.999957e-01 9.999968e-01 9.999978e-01 9.999986e-01 9.999992e-01 9.999996e-01 ## Comp65 Comp66 Comp67 Comp68 Comp69 Comp70 ## Eigenvalues 6.341309e-09 2.444382e-09 1.577368e-09 1.079013e-09 4.814093e-11 6.761559e-35 ## Proportion of Variance 2.296254e-07 8.851360e-08 5.711813e-08 3.907219e-08 1.743233e-09 2.448430e-33 ## Cumulative Proportion 9.999998e-01 9.999999e-01 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 # set plot parameters pch.gps &lt;- c(3,15:18)[as.factor(region)] col.gps &lt;- pal[as.factor(region)] col.hull &lt;- c(&quot;#00A08A&quot;,&quot;#FF0000&quot;,&quot;#F2AD00&quot;,&quot;#F98400&quot;,&quot;#5BBCD6&quot;) # pca plot pc.plot &lt;- plot(pca, asp = 1, pch = pch.gps, col = col.gps) shapeHulls(pc.plot, groups = region, group.cols = col.hull) # identify shapes at x/y extremes #picknplot.shape(pc.plot) # pca warp #knitr::include_graphics(&#39;./img/pca.warp.jpg&#39;) 2.6 Procrustes ANOVA - allometry A residual randomisation permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Michael L. Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes differ by group (geography and time), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (M. L. Collyer, Sekora, and Adams 2015). # general allometry fit.size &lt;- procD.lm(shape ~ size, data = gdf, print.progress = FALSE, iter = 9999) # general allometry? anova(fit.size) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.14079 0.140794 0.07389 5.4253 2.6833 0.0016 ** ## Residuals 68 1.76470 0.025952 0.92611 ## Total 69 1.90550 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size, iter = 9999, data = gdf, print.progress = FALSE) 2.7 Procrustes ANOVA - shape and size A residual randomisation permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Michael L. Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes differ by group (geography and time), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (M. L. Collyer, Sekora, and Adams 2015). # size fit.sz.reg &lt;- procD.lm(size ~ region, data = gdf, print.progress = FALSE, iter = 9999) # size anova(fit.sz.reg) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## region 4 6846.9 1711.74 0.25007 5.4187 2.7356 0.0061 ** ## Residuals 65 20533.0 315.89 0.74993 ## Total 69 27379.9 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = size ~ region, iter = 9999, data = gdf, print.progress = FALSE) # pairwise comparison of LS means = which differ? sz.reg &lt;- pairwise(fit.sz.reg, groups = qdata$region) summary(sz.reg, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: blackland prairies edwards plateau gulf coast prairies and marshes oak woods and parairies piney woods ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## blackland prairies:edwards plateau 0.3537424 28.08725 -2.1047072 0.9813 ## blackland prairies:gulf coast prairies and marshes 11.5316983 27.92845 0.2578440 0.4249 ## blackland prairies:oak woods and parairies 3.7736415 32.99148 -0.9409509 0.8163 ## blackland prairies:piney woods 12.7467382 27.34488 0.4007684 0.3706 ## edwards plateau:gulf coast prairies and marshes 11.8854408 12.86254 1.4492884 0.0712 ## edwards plateau:oak woods and parairies 4.1273839 20.20468 -0.4757572 0.6818 ## edwards plateau:piney woods 12.3929958 12.09794 1.6354563 0.0450 ## gulf coast prairies and marshes:oak woods and parairies 7.7580569 20.00459 0.2191150 0.4319 ## gulf coast prairies and marshes:piney woods 24.2784366 11.67024 3.1440569 0.0001 ## oak woods and parairies:piney woods 16.5203797 19.37602 1.3324007 0.0876 # shape fit.sh.reg &lt;- procD.lm(shape ~ region, data = gdf, print.progress = FALSE, iter = 9999) # shape anova(fit.sh.reg) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## region 4 0.15222 0.038055 0.07988 1.4108 1.0485 0.1496 ## Residuals 65 1.75328 0.026973 0.92012 ## Total 69 1.90550 ## ## Call: procD.lm(f1 = shape ~ region, iter = 9999, data = gdf, print.progress = FALSE) 2.8 Morphological integration land.gps &lt;- c(&quot;A&quot;,&quot;A&quot;,&quot;B&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;, &quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;, &quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;) it &lt;- integration.test(Y.gpa$coords, partition.gp = land.gps, iter = 9999, print.progress = FALSE) summary(it) ## ## Call: ## integration.test(A = Y.gpa$coords, partition.gp = land.gps, iter = 9999, print.progress = FALSE) ## ## ## ## r-PLS: 0.9185 ## ## Effect Size (Z): 6.59842 ## ## P-value: 1e-04 ## ## Based on 10000 random permutations plot(it) 2.9 Morphological disparity morphol.disparity(shape ~ region, groups = qdata$region, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = shape ~ region, groups = qdata$region, iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## blackland prairies edwards plateau gulf coast prairies and marshes ## 0.01010879 0.03237101 0.01844574 ## oak woods and parairies piney woods ## 0.02338077 0.02680510 ## ## ## Pairwise absolute differences between variances ## blackland prairies edwards plateau gulf coast prairies and marshes oak woods and parairies ## blackland prairies 0.000000000 0.022262217 0.008336949 0.013271984 ## edwards plateau 0.022262217 0.000000000 0.013925268 0.008990233 ## gulf coast prairies and marshes 0.008336949 0.013925268 0.000000000 0.004935035 ## oak woods and parairies 0.013271984 0.008990233 0.004935035 0.000000000 ## piney woods 0.016696312 0.005565905 0.008359363 0.003424328 ## piney woods ## blackland prairies 0.016696312 ## edwards plateau 0.005565905 ## gulf coast prairies and marshes 0.008359363 ## oak woods and parairies 0.003424328 ## piney woods 0.000000000 ## ## ## P-Values ## blackland prairies edwards plateau gulf coast prairies and marshes oak woods and parairies ## blackland prairies 1.0000 0.0938 0.5718 0.3866 ## edwards plateau 0.0938 1.0000 0.0232 0.3497 ## gulf coast prairies and marshes 0.5718 0.0232 1.0000 0.6050 ## oak woods and parairies 0.3866 0.3497 0.6050 1.0000 ## piney woods 0.1859 0.3529 0.1392 0.7153 ## piney woods ## blackland prairies 0.1859 ## edwards plateau 0.3529 ## gulf coast prairies and marshes 0.1392 ## oak woods and parairies 0.7153 ## piney woods 1.0000 2.10 Mean shapes # subset landmark coordinates to produce mean shapes new.coords &lt;- coords.subset(A = Y.gpa$coords, group = qdata$region) names(new.coords) ## [1] &quot;blackland prairies&quot; &quot;edwards plateau&quot; &quot;gulf coast prairies and marshes&quot; ## [4] &quot;oak woods and parairies&quot; &quot;piney woods&quot; # group shape means mean &lt;- lapply(new.coords, mshape) # plot mean shapes plot(mean$`blackland prairies`) plot(mean$`edwards plateau`) plot(mean$`gulf coast prairies and marshes`) plot(mean$`oak woods and parairies`) plot(mean$`piney woods`) # comparison plots plotRefToTarget(mean$`blackland prairies`, mean$`edwards plateau`, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$`blackland prairies`, mean$`gulf coast prairies and marshes`, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$`blackland prairies`, mean$`oak woods and parairies`, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$`blackland prairies`, mean$`piney woods`, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$`edwards plateau`, mean$`gulf coast prairies and marshes`, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$`edwards plateau`, mean$`oak woods and parairies`, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$`edwards plateau`, mean$`piney woods`, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$`gulf coast prairies and marshes`, mean$`oak woods and parairies`, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$`gulf coast prairies and marshes`, mean$`piney woods`, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$`oak woods and parairies`, mean$`piney woods`, method = &quot;points&quot;, mag = 1) "],["river-basins.html", "Chapter 3 River basins 3.1 Read data and define sLMs 3.2 Read qualitative data 3.3 Generalised Procrustes Analysis 3.4 Boxplot 3.5 Principal Components Analysis 3.6 Procrustes ANOVA - shape and size 3.7 Morphological disparity 3.8 Mean shapes", " Chapter 3 River basins library(here) library(StereoMorph) library(geomorph) library(wesanderson) library(ggplot2) 3.1 Read data and define sLMs shapes &lt;- readShapes(&quot;shapes&quot;) shapesGM &lt;- readland.shapes(shapes, nCurvePts = c(10, 10, 10, 10)) 3.2 Read qualitative data qdata &lt;- read.csv(&quot;qdata.csv&quot;, header = TRUE, row.names = 1) 3.3 Generalised Procrustes Analysis Landmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalised Procrustes superimposition (Rohlf and Slice 1990) performed in R 4.0.4 (R Core Development Team, 2020) using the geomorph library v. 3.3.2 (Adams et al. 2017; Adams and Otárola-Castillo 2013). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001). Y.gpa &lt;- gpagen(shapesGM, print.progress = FALSE) plot(Y.gpa) # dataframe gdf &lt;- geomorph.data.frame(shape = Y.gpa$coords, size = Y.gpa$Csize, river = qdata$river) # add centroid size to qdata qdata$csz &lt;- Y.gpa$Csize # revised table of attributes knitr::kable(qdata, align = &quot;lccc&quot;, caption = &quot;Attributes of Perdiz arrow points included in the sample.&quot;) (#tab:gp.river)Attributes of Perdiz arrow points included in the sample. county river region csz perdiz001a kimble Colorado edwards plateau 69.35797 perdiz001b kimble Colorado edwards plateau 73.14749 perdiz001c kimble Colorado edwards plateau 58.52238 perdiz002 kimble Colorado edwards plateau 70.84758 perdiz003 bosque Colorado blackland prairies 60.02730 perdiz004e kimble Colorado edwards plateau 60.43875 perdiz004g kimble Colorado edwards plateau 50.37065 perdiz005a JW, hinojosa site NRG gulf coast prairies and marshes 38.60532 perdiz005b JW, hinojosa site NRG gulf coast prairies and marshes 36.04801 perdiz005c JW, hinojosa site NRG gulf coast prairies and marshes 31.63170 perdiz005e JW, hinojosa site NRG gulf coast prairies and marshes 38.73303 perdiz005g JW, hinojosa site NRG gulf coast prairies and marshes 42.18146 perdiz005h JW, hinojosa site NRG gulf coast prairies and marshes 40.21831 perdiz005i JW, hinojosa site NRG gulf coast prairies and marshes 46.89038 perdiz005j JW, hinojosa site NRG gulf coast prairies and marshes 47.12634 perdiz005k JW, hinojosa site NRG gulf coast prairies and marshes 44.19071 perdiz005L JW, hinojosa site NRG gulf coast prairies and marshes 49.62448 perdiz005o JW, hinojosa site NRG gulf coast prairies and marshes 50.95445 perdiz005q JW, hinojosa site NRG gulf coast prairies and marshes 54.49649 perdiz005r JW, hinojosa site NRG gulf coast prairies and marshes 56.57031 perdiz005t JW, hinojosa site NRG gulf coast prairies and marshes 64.34497 perdiz005u JW, hinojosa site NRG gulf coast prairies and marshes 64.37136 perdiz005x JW, hinojosa site NRG gulf coast prairies and marshes 71.34271 perdiz006a JW, hinojosa site NRG gulf coast prairies and marshes 56.62909 perdiz006b JW, hinojosa site NRG gulf coast prairies and marshes 53.55270 perdiz006g JW, hinojosa site NRG gulf coast prairies and marshes 48.91144 perdiz006h JW, hinojosa site NRG gulf coast prairies and marshes 46.08079 perdiz007 McLennan Brazos blackland prairies 61.28651 perdiz008cap uvalde Nueces edwards plateau 77.02208 perdiz008iap uvalde Nueces edwards plateau 74.75191 perdiz008oap uvalde Nueces edwards plateau 49.62793 perdiz008pap uvalde Nueces edwards plateau 50.87638 perdiz008x uvalde Nueces edwards plateau 43.59739 perdiz010 hamilton Brazos oak woods and parairies 70.21314 perdiz011 lampass Brazos edwards plateau 72.06248 perdiz012a burleson Brazos oak woods and parairies 46.88491 perdiz012c burleson Brazos oak woods and parairies 50.39119 perdiz014 lee Brazos oak woods and parairies 54.06644 perdiz015 comal Guadalupe edwards plateau 55.79778 perdiz016 hays Guadalupe edwards plateau 54.92731 perdiz017a hays Guadalupe edwards plateau 71.77669 perdiz017d hays Guadalupe edwards plateau 41.21730 perdiz017f hays Guadalupe edwards plateau 62.83886 perdiz018 burleson Brazos oak woods and parairies 62.86062 perdiz020a nacogdoches Neches piney woods 84.92990 perdiz020b nacogdoches Neches piney woods 88.53429 perdiz020c nacogdoches Neches piney woods 93.11325 perdiz021a nacogdoches Neches piney woods 73.68651 perdiz021b nacogdoches Neches piney woods 76.01294 perdiz021c nacogdoches Neches piney woods 90.56510 perdiz021d nacogdoches Neches piney woods 82.10799 perdiz021e nacogdoches Neches piney woods 79.06205 perdiz021f nacogdoches Neches piney woods 84.65951 perdiz021g nacogdoches Neches piney woods 83.23678 perdiz021h nacogdoches Neches piney woods 106.71703 perdiz021i nacogdoches Neches piney woods 148.79264 perdiz022h smith Neches piney woods 38.75136 perdiz022i smith Neches piney woods 43.52312 perdiz022j smith Neches piney woods 39.80383 perdiz022k smith Neches piney woods 36.64441 perdiz022L smith Neches piney woods 38.71038 perdiz022m smith Neches piney woods 41.86583 perdiz023a smith Neches piney woods 78.64626 perdiz023b smith Neches piney woods 78.28938 perdiz023c smith Neches piney woods 80.12793 perdiz023e smith Neches piney woods 77.31495 perdiz023f smith Neches piney woods 80.30418 perdiz023g smith Neches piney woods 63.26502 perdiz024j smith Neches piney woods 44.17576 perdiz025c smith Neches piney woods 75.65424 3.4 Boxplot # attributes csz &lt;- qdata$csz river &lt;- qdata$river # palette pal = wes_palette(&quot;Darjeeling1&quot;, 6, type = &quot;continuous&quot;) # boxplot of Perdiz arrow points by river csz.riv &lt;- ggplot(qdata, aes(x = river, y = csz, color = river)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_color_manual(values = pal) + theme(legend.position = &quot;none&quot;) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + labs(x = &#39;River basin&#39;, y = &#39;Centroid Size&#39;) # render plot csz.riv ## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`. 3.5 Principal Components Analysis Principal components analysis (Jolliffe 2002) was used to visualise shape variation among the bottles. The shape changes described by each principal axis are commonly visualised using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014). # pca pca &lt;- gm.prcomp(Y.gpa$coords) summary(pca) ## ## Ordination type: Principal Component Analysis ## Centering by OLS mean ## Orthogonal projection of OLS residuals ## Number of observations: 70 ## Number of vectors 70 ## ## Importance of Components: ## Comp1 Comp2 Comp3 Comp4 Comp5 Comp6 Comp7 Comp8 ## Eigenvalues 0.0133888 0.00763512 0.002277268 0.001174328 0.0008016969 0.0005434213 0.0004363314 0.0002189984 ## Proportion of Variance 0.4848225 0.27647560 0.082462223 0.042523634 0.0290302741 0.0196778491 0.0158000126 0.0079301596 ## Cumulative Proportion 0.4848225 0.76129808 0.843760298 0.886283932 0.9153142064 0.9349920556 0.9507920681 0.9587222278 ## Comp9 Comp10 Comp11 Comp12 Comp13 Comp14 Comp15 ## Eigenvalues 0.0001830032 0.000138613 0.0001254942 0.000120320 8.565046e-05 7.500234e-05 5.588002e-05 ## Proportion of Variance 0.0066267365 0.005019321 0.0045442736 0.004356912 3.101492e-03 2.715913e-03 2.023473e-03 ## Cumulative Proportion 0.9653489643 0.970368285 0.9749125589 0.979269470 9.823710e-01 9.850869e-01 9.871103e-01 ## Comp16 Comp17 Comp18 Comp19 Comp20 Comp21 Comp22 ## Eigenvalues 4.794711e-05 3.799271e-05 3.720787e-05 3.334601e-05 2.508818e-05 2.368646e-05 1.879945e-05 ## Proportion of Variance 1.736215e-03 1.375756e-03 1.347336e-03 1.207494e-03 9.084689e-04 8.577114e-04 6.807477e-04 ## Cumulative Proportion 9.888466e-01 9.902223e-01 9.915697e-01 9.927771e-01 9.936856e-01 9.945433e-01 9.952241e-01 ## Comp23 Comp24 Comp25 Comp26 Comp27 Comp28 Comp29 ## Eigenvalues 1.714548e-05 1.584305e-05 1.108422e-05 1.091661e-05 9.222024e-06 8.875078e-06 7.861366e-06 ## Proportion of Variance 6.208557e-04 5.736934e-04 4.013712e-04 3.953016e-04 3.339390e-04 3.213758e-04 2.846682e-04 ## Cumulative Proportion 9.958449e-01 9.964186e-01 9.968200e-01 9.972153e-01 9.975492e-01 9.978706e-01 9.981553e-01 ## Comp30 Comp31 Comp32 Comp33 Comp34 Comp35 Comp36 ## Eigenvalues 7.098653e-06 6.020584e-06 5.162380e-06 4.611750e-06 3.632503e-06 3.570610e-06 3.013451e-06 ## Proportion of Variance 2.570496e-04 2.180116e-04 1.869351e-04 1.669962e-04 1.315367e-04 1.292955e-04 1.091202e-04 ## Cumulative Proportion 9.984123e-01 9.986303e-01 9.988173e-01 9.989843e-01 9.991158e-01 9.992451e-01 9.993542e-01 ## Comp37 Comp38 Comp39 Comp40 Comp41 Comp42 Comp43 ## Eigenvalues 2.723580e-06 2.244377e-06 1.784666e-06 1.488843e-06 1.367558e-06 1.199828e-06 1.078477e-06 ## Proportion of Variance 9.862365e-05 8.127120e-05 6.462460e-05 5.391254e-05 4.952068e-05 4.344702e-05 3.905277e-05 ## Cumulative Proportion 9.994528e-01 9.995341e-01 9.995987e-01 9.996527e-01 9.997022e-01 9.997456e-01 9.997847e-01 ## Comp44 Comp45 Comp46 Comp47 Comp48 Comp49 Comp50 ## Eigenvalues 1.043211e-06 9.672424e-07 7.513816e-07 6.535789e-07 5.022591e-07 4.111047e-07 3.271620e-07 ## Proportion of Variance 3.777577e-05 3.502485e-05 2.720831e-05 2.366677e-05 1.818732e-05 1.488653e-05 1.184688e-05 ## Cumulative Proportion 9.998225e-01 9.998575e-01 9.998847e-01 9.999084e-01 9.999265e-01 9.999414e-01 9.999533e-01 ## Comp51 Comp52 Comp53 Comp54 Comp55 Comp56 Comp57 ## Eigenvalues 2.927700e-07 2.208875e-07 1.707167e-07 1.175671e-07 1.010394e-07 8.530899e-08 7.278124e-08 ## Proportion of Variance 1.060150e-05 7.998565e-06 6.181827e-06 4.257227e-06 3.658740e-06 3.089127e-06 2.635484e-06 ## Cumulative Proportion 9.999639e-01 9.999719e-01 9.999781e-01 9.999823e-01 9.999860e-01 9.999891e-01 9.999917e-01 ## Comp58 Comp59 Comp60 Comp61 Comp62 Comp63 Comp64 ## Eigenvalues 6.711195e-08 4.434921e-08 3.069964e-08 2.658065e-08 2.184144e-08 1.563845e-08 1.158589e-08 ## Proportion of Variance 2.430193e-06 1.605931e-06 1.111666e-06 9.625130e-07 7.909012e-07 5.662844e-07 4.195370e-07 ## Cumulative Proportion 9.999941e-01 9.999957e-01 9.999968e-01 9.999978e-01 9.999986e-01 9.999992e-01 9.999996e-01 ## Comp65 Comp66 Comp67 Comp68 Comp69 Comp70 ## Eigenvalues 6.341309e-09 2.444382e-09 1.577368e-09 1.079013e-09 4.814093e-11 6.761559e-35 ## Proportion of Variance 2.296254e-07 8.851360e-08 5.711813e-08 3.907219e-08 1.743233e-09 2.448430e-33 ## Cumulative Proportion 9.999998e-01 9.999999e-01 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 # set plot parameters pch.gps &lt;- c(3,15:19)[as.factor(river)] col.gps &lt;- pal[as.factor(river)] col.hull &lt;- c(&quot;#32806E&quot;,&quot;#D98F2A&quot;,&quot;#FF0000&quot;,&quot;#5BBCD6&quot;,&quot;#91A737&quot;,&quot;#F49C00&quot;) # pca plot pc.plot &lt;- plot(pca, asp = 1, pch = pch.gps, col = col.gps) shapeHulls(pc.plot, groups = river, group.cols = col.hull) # identify shapes at x/y extremes #picknplot.shape(pc.plot) # pca warp #knitr::include_graphics(&#39;./img/pca.warp.jpg&#39;) 3.6 Procrustes ANOVA - shape and size A residual randomisation permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Michael L. Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes differ by group (geography and time), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (M. L. Collyer, Sekora, and Adams 2015). # size fit.sz.reg &lt;- procD.lm(size ~ river, data = gdf, print.progress = FALSE, iter = 9999) # size anova(fit.sz.reg) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## river 5 6894.1 1378.82 0.25179 4.3076 2.7384 0.0039 ** ## Residuals 64 20485.8 320.09 0.74821 ## Total 69 27379.9 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = size ~ river, iter = 9999, data = gdf, print.progress = FALSE) # pairwise comparison of LS means = which differ? sz.reg &lt;- pairwise(fit.sz.reg, groups = qdata$river) summary(sz.reg, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: Brazos Colorado Guadalupe Neches NRG Nueces ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## Brazos:Colorado 3.5638328 21.04885 -0.6609349 0.7355 ## Brazos:Guadalupe 2.3691679 22.84677 -1.0211123 0.8256 ## Brazos:Neches 13.7228838 16.67451 1.2715688 0.1039 ## Brazos:NRG 10.5555528 17.27632 0.7969237 0.2284 ## Brazos:Nueces 0.5056165 22.84134 -1.8309113 0.9619 ## Colorado:Guadalupe 5.9330007 23.21192 -0.2443690 0.6013 ## Colorado:Neches 10.1590510 16.60820 0.7911943 0.2272 ## Colorado:NRG 14.1193856 17.19906 1.2571203 0.1043 ## Colorado:Nueces 4.0694493 23.27898 -0.6120050 0.7202 ## Guadalupe:Neches 16.0920517 18.84277 1.3017145 0.0935 ## Guadalupe:NRG 8.1863849 19.51490 0.2828632 0.4049 ## Guadalupe:Nueces 1.8635514 24.97516 -1.2529113 0.8819 ## Neches:NRG 24.2784366 11.67024 3.1440569 0.0001 ## Neches:Nueces 14.2285003 19.23908 1.0902474 0.1400 ## NRG:Nueces 10.0499363 19.65880 0.5590579 0.3060 # shape fit.sh.reg &lt;- procD.lm(shape ~ river, data = gdf, print.progress = FALSE, iter = 9999) # shape anova(fit.sh.reg) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## river 5 0.1994 0.039881 0.10465 1.496 1.2943 0.0969 . ## Residuals 64 1.7061 0.026658 0.89535 ## Total 69 1.9055 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ river, iter = 9999, data = gdf, print.progress = FALSE) 3.7 Morphological disparity morphol.disparity(shape ~ river, groups = qdata$river, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = shape ~ river, groups = qdata$river, iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## Brazos Colorado Guadalupe Neches NRG Nueces ## 0.02195729 0.02004218 0.02061773 0.02680510 0.01844574 0.04863202 ## ## ## Pairwise absolute differences between variances ## Brazos Colorado Guadalupe Neches NRG Nueces ## Brazos 0.000000000 0.001915109 0.001339561 0.004847810 0.003511553 0.02667472 ## Colorado 0.001915109 0.000000000 0.000575548 0.006762920 0.001596443 0.02858983 ## Guadalupe 0.001339561 0.000575548 0.000000000 0.006187372 0.002171991 0.02801429 ## Neches 0.004847810 0.006762920 0.006187372 0.000000000 0.008359363 0.02182691 ## NRG 0.003511553 0.001596443 0.002171991 0.008359363 0.000000000 0.03018628 ## Nueces 0.026674724 0.028589834 0.028014286 0.021826914 0.030186277 0.00000000 ## ## ## P-Values ## Brazos Colorado Guadalupe Neches NRG Nueces ## Brazos 1.0000 0.8371 0.8936 0.5293 0.6582 0.0131 ## Colorado 0.8371 1.0000 0.9537 0.3704 0.8465 0.0074 ## Guadalupe 0.8936 0.9537 1.0000 0.4782 0.8190 0.0142 ## Neches 0.5293 0.3704 0.4782 1.0000 0.1182 0.0133 ## NRG 0.6582 0.8465 0.8190 0.1182 1.0000 0.0020 ## Nueces 0.0131 0.0074 0.0142 0.0133 0.0020 1.0000 3.8 Mean shapes # subset landmark coordinates to produce mean shapes new.coords &lt;- coords.subset(A = Y.gpa$coords, group = qdata$river) names(new.coords) ## [1] &quot;Brazos&quot; &quot;Colorado&quot; &quot;Guadalupe&quot; &quot;Neches&quot; &quot;NRG&quot; &quot;Nueces&quot; # group shape means mean &lt;- lapply(new.coords, mshape) # plot mean shapes plot(mean$Brazos) plot(mean$Colorado) plot(mean$Guadalupe) plot(mean$Neches) plot(mean$Nueces) plot(mean$NRG) # comparison plots plotRefToTarget(mean$Brazos, mean$Colorado, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Brazos, mean$Guadalupe, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Brazos, mean$Neches, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Brazos, mean$NRG, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Brazos, mean$Nueces, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Colorado, mean$Guadalupe, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Colorado, mean$Neches, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Colorado, mean$NRG, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Colorado, mean$Nueces, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Guadalupe, mean$Neches, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Guadalupe, mean$NRG, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Guadalupe, mean$Nueces, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Neches, mean$NRG, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$Neches, mean$Nueces, method = &quot;points&quot;, mag = 1) plotRefToTarget(mean$NRG, mean$Nueces, method = &quot;points&quot;, mag = 1) "],["references.html", "References", " References Adams, Dean C., and Michael L. Collyer. 2015. Permutation Tests for Phylogenetic Comparative Analyses of High-Dimensional Shape Data: What you Shuffle Matters. Evolution 69 (3): 82329. https://doi.org/10.1111/evo.12596. Adams, Dean C., Michael L. Collyer, Antigoni Kaliontzopoulou, and Emma Sherratt. 2017. Package geomorph: Geometric Morphometric Analyses of 2D/3D Landmark Data. R package version 3.0.5. http://geomorphr.github.io/geomorph/. Adams, Dean C., and Erik Otárola-Castillo. 2013. geomorph: An R Package for the Collection and Analysis of Geometric Morphometric Shape Data. Methods in Ecology and Evolution 4 (4): 39399. https://doi.org/10.1111/2041-210x.12035. Anderson, M. J., and C. J. F. Ter Braak. 2003. Permutation Tests for Multi-Factoral Analysis of Variance. Journal of Statistical Computation and Simulation 73 (2): 85113. https://doi.org/10.1080=0094965021000015558. Collyer, M. L., D. J. Sekora, and D. C. Adams. 2015. A Method for Analysis of Phenotypic Change for Phenotypes Described by High-Dimensional Data. Heredity 115 (4): 35765. https://doi.org/10.1038/hdy.2014.75. Collyer, Michael L., and Dean C. Adams. 2018. RRPP: An R Package for Fitting Linear Models to High-Dimensional Data using Residual Randomization. Methods in Ecology and Evolution 9 (7): 177279. https://doi.org/https://doi.org/10.1111/2041-210X.13029. Gandrud, Christopher. 2014. Reproducible Research with r and RStudio. The r Series. London: CRC Press. . 2014. Reproducible Research with r and RStudio. The r Series. London: CRC Press. Goodall, Colin. 1991. Procrustes Methods in the Statistical Analysis of Shape. Journal of the Royal Statistical Society. Series B (Methodological) 53 (2): 285339. Gower, J. C. 1975. Generalized Procrustes Analysis. Psychometrika 40 (1): 3351. https://doi.org/https://doi.org/10.1007/BF02291478. Gray, Charles T., and Ben Marwick. 2019. Truth, Proof, and Reproducibility: Theres No Counter-Attack for the Codeless. In Statistics and Data Science, 11129. Communications in Computer and Information Science. https://doi.org/10.1007/978-981-15-1960-4_8. . 2019. Truth, Proof, and Reproducibility: Theres No Counter-Attack for the Codeless. In Statistics and Data Science, 11129. Communications in Computer and Information Science. https://doi.org/10.1007/978-981-15-1960-4_8. Jolliffe, Ian T. 2002. Principal Component Analysis. New York: Springer. Kendall, David G. 1981. The Statistics of Shape. In Interpreting Multivariate Data, edited by V. Barnett, 7580. New York: Wiley. . 1984. Shape Manifolds, Procrustean Metrics, and Complex Projective Spaces. Bulletin of the London Mathematical Society 16 (2): 81121. https://doi.org/10.1112/blms/16.2.81. Klingenberg, Christian Peter. 2013. Visualizations in Geometric Morphometrics: How to Read and How to Make Graphs Showing Shape Changes. Hystrix 24 (1): 1524. https://doi.org/http://dx.doi.org/10.4404/hystrix-24.1-7691. Leek, Jeffrey T., and Roger D. Peng. 2015. Opinion: Reproducible Research Can Still Be Wrong: Adopting a Prevention Approach. Proc Natl Acad Sci U S A 112 (6): 164546. https://doi.org/10.1073/pnas.1421412111. . 2015. Opinion: Reproducible Research Can Still Be Wrong: Adopting a Prevention Approach. Proc Natl Acad Sci U S A 112 (6): 164546. https://doi.org/10.1073/pnas.1421412111. Peng, Roger D. 2011. Reproducible Research in Computational Science. Science 334 (6060): 122627. https://doi.org/10.1126/science.1213847. . 2011. Reproducible Research in Computational Science. Science 334 (6060): 122627. https://doi.org/10.1126/science.1213847. R Core Development Team,. 2020. R: A Language and Environment for Statistical Computing. Vienna, Austria: R Foundation for Statistical Computing. http://www.R-project.org/. Rohlf, F. James. 1999. Shape Statistics: Procrustes Superimpositions and Tangent Spaces. Journal of Classification 16 (2): 197223. https://doi.org/10.1007/s003579900054. Rohlf, F. James, and Dennis Slice. 1990. Extensions of the Procrustes Method for the Optimal Superimposition of Landmarks. Systematic Zoology 39 (1): 4059. https://doi.org/10.2307/2992207. Sherratt, E., D. J. Gower, C. P. Klingenberg, and M. Wilkinson. 2014. Evolution of Cranial Shape in Caecilians (Amphibia: Gymnophiona). Evolutionary Biology 41 (4): 52845. https://doi.org/https://doi.org/10.1007/s11692-014-9287-2. Slice, Dennis E. 2001. Landmark Coordinates Aligned by Procrustes Analysis Do Not Lie in Kendalls Shape Space. Systematic Biology 50 (1): 14149. https://doi.org/10.1080/10635150119110. "]]
